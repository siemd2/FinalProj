@page "/customermanagement"
@using FinalProj.Data.Models
@using FinalProj.Data.Controllers

<h3>Customer Management System</h3>
<br />
<br />
<!-- error message -->
<p class="text-danger" hidden="@(!ShowErrorMessage)">Please select a customer, staff member, and service before attempting to book an appointment.</p>
<br />

<div class="input-group">
	<span class="input-group-text">Customer ID:</span>
	<input type="number" @bind="CustomerId" class="form-control" />
</div>
<br />
<div>
	<button type="button" class="btn btn-outline-primary" @onclick="GenerateID">Generate ID</button>
	<span class="generated-id-label">New Id: </span>
	<span class="generated-id">@NewID</span>
</div>
<br />
<div class="input-group">
	<span class="input-group-text">Customer Full Name:</span>
	<input type="text" @bind="CustomerName" class="form-control" />
</div>
<br />
<div class="input-group">
	<span class="input-group-text">Customer Phone #:</span>
	<input type="number" @bind="CustomerPhone" class="form-control" />
</div>
<br />
<div class="input-group">
	<span class="input-group-text">Customer E-mail:</span>
	<input type="email" @bind="CustomerEmail" class="form-control" />
</div>
<br />
<div class="input-group">
	<span class="input-group-text">Customer Address:</span>
	<input type="text" @bind="CustomerAddress" class="form-control" />
</div>
<br />
<br />
<button type="button" class="btn btn-outline-success" @onclick="AddCustomer">Add Customer</button>
<br />
<br />
<!-- confirmation message -->
<p class="text-success" hidden="@(!ShowSuccessMessage)">Customer Added To DataBase.</p>
<br />
<br />
<br />


@code {
	string CustomerId { get; set; }
	string CustomerName { get; set; }
	string CustomerPhone { get; set; }
	string CustomerEmail { get; set; }
	string CustomerAddress { get; set; }
	string NewID { get; set; }

	Customer customer = new Customer();
	CustManagement custManagement = new CustManagement();

	bool ShowSuccessMessage { get; set; }
	bool ShowErrorMessage { get; set; }

	public void AddCustomer()
	{
		if (CustomerId != null && CustomerName != null && CustomerPhone != null && CustomerEmail != null && CustomerAddress != null)
		{
			int.TryParse(CustomerId, out int id);
			int.TryParse(CustomerPhone, out int phone);
			customer.UserId = id;
			customer.UserName = string.IsNullOrEmpty(CustomerName) ? string.Empty : CustomerName;
			customer.PhoneNumber = phone;
			customer.Email = string.IsNullOrEmpty(CustomerEmail) ? string.Empty : CustomerEmail;
			customer.Address = string.IsNullOrEmpty(CustomerAddress) ? string.Empty : CustomerAddress;

			custManagement.SaveCustomerToDB(customer);

			ShowErrorMessage = false;
			ShowSuccessMessage = true;
		}
		else
		{
			ShowErrorMessage = true;
			ShowSuccessMessage = false;
		}

	}

	public void GenerateID()
	{
		NewID = UniqueIntGenerator.GenerateUniqueInt().ToString();
	}
}